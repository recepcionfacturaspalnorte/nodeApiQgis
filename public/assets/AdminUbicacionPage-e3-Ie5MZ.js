import{i as p,k as v,u as N,l as E,m as y,n as U,t as b,o as m,p as S,b as A,j as e,e as f,A as q,B as g,L as B,X as D,q as I,T as O,s as P,v as j,w as T,N as w,r as k}from"./index-qlHXIeU4.js";const F=async a=>{const{id:s,files:o=[],...c}=a,i=s==="new";console.log("like in action create"),console.log({userLike:a});const{data:n}=await p({url:i?"/ubicacion/":`/ubicacion/${s}`,method:i?"POST":"PUT",data:{...c}});return{...n}},$=async a=>{console.log(a);const{data:s}=await p({url:`/ubicacion/${a}`,method:"DELETE"});return{...s}},Q=async a=>{if(!a)throw new Error("Id is required");if(a==="new")return console.log("llega a new"),{id:"new",COD_UBICACION:"",detalle:""};const{data:s}=await p.get(`/ubicacion/${a}`);return s},K=a=>{const s=v(),o=N(),c=E({queryKey:["ubicacion",{id:a}],queryFn:()=>Q(a),retry:!1,staleTime:1e3*60*.5}),i=y({mutationFn:F,onSuccess:r=>{s.invalidateQueries({queryKey:["ubicaciones"]}),s.invalidateQueries({queryKey:["ubicacion"]})}}),n=y({mutationFn:$,onSuccess:r=>{s.invalidateQueries({queryKey:["ubicaciones"]}),o(-1),b.success("Se ha  eliminado correctamente")},onError:r=>{console.error(r),b.error("Error al eliminar")}});return{...c,mutation:i,mutationDelete:n,handleSubmit:async r=>{event?.preventDefault(),console.log("onsubmit",r),await i.mutateAsync(r,{onSuccess:t=>{console.log({data:t});let l="Ubicación actualizada ";r.id==="new"&&(l="Ubicación Creada "),m.fire({title:"Exito",text:l,icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),o(`/admin/ubicaciones/${t.id}`)},onError:t=>{console.log(t),m.fire({title:"<b>Error al Guardar</b>",text:`${t?.response?.data?.error||t.message||"Error desconocido"}`,icon:"error"})}})},handleDelete:async r=>{(await U()).isConfirmed&&await n.mutateAsync(r,{onSuccess:l=>{m.fire({title:"Exito",text:"Eliminado Correctamente",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),o(`/admin/ubicaciones/${l.id}`)},onError:l=>{console.log(l),b.success("Error al Eliminar"),m.fire({title:"Error",text:"Error al Eliminar",icon:"error",confirmButtonColor:"#16a34a",background:"#1f2937",color:"#f9fafb"})}})}}},_=({title:a,subTitle:s,onSubmit:o,handleDelete:c,clase:i,isPending:n,isDeleting:u})=>{const{register:d,handleSubmit:r,formState:{errors:t},getValues:l,setValue:L,watch:G}=S({defaultValues:i}),h=A().pathname.split("/").filter(Boolean),C=h[h.length-1];let x=!1;return C==="new"&&(x=!0),n||u?e.jsx(f,{}):e.jsxs("form",{className:"py-0 pb-10",onSubmit:r(o),children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 flex flex-col gap-4",children:[e.jsx(q,{title:a,subtitle:s}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{variant:"outline",type:"button",children:e.jsxs(B,{to:"/admin/ubicaciones",className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Cancelar"]})}),e.jsxs(g,{type:"submit",disabled:n,children:[e.jsx(I,{className:"w-4 h-4"}),"Guardar"]}),!x&&e.jsxs(g,{onClick:()=>c(+i.id),variant:"destructive",type:"button",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 py-8",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Información de Ubicación"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:["Código",e.jsx("img",{src:P,alt:"Campo llave",className:"w-4 h-4 ml-2"})]})}),e.jsx("input",{readOnly:!x,type:"text",...d("COD_UBICACION",{required:!0}),className:j("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":t.COD_UBICACION}),placeholder:"Ingrese Código"}),t.COD_UBICACION&&e.jsx("p",{className:"text-red-500 text-sm",children:"El Código es requerido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Detalle"}),e.jsx("input",{type:"text",...d("detalle",{required:!0}),className:j("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":t.detalle}),placeholder:"Nombre"}),t.detalle&&e.jsx("p",{className:"text-red-500 text-sm",children:"el Nomvre de la Ubicación  es requerido"})]})]})]})})})})]})},M=()=>{const{id:a}=T();N();const{isLoading:s,isError:o,data:c,mutation:i,mutationDelete:n,handleDelete:u,handleSubmit:d}=K(a||""),r=a==="new"?"Nueva Ubicación":"Editar Ubicación",t=a==="new"?"Aquí puedes crear una nueva Ubicación.":"Aquí puedes editar la Ubicación.";return o?e.jsx(w,{to:"/admin/ubicaciones"}):s?e.jsx(f,{}):c?e.jsx(e.Fragment,{children:e.jsx(k.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(_,{title:r,subTitle:t,clase:c,onSubmit:d,handleDelete:u,isPending:i.isPending,isDeleting:n.isPending})})}):e.jsx(w,{to:"/admin/ubicaciones"})};export{M as AdminUbicacionPage,M as default};
