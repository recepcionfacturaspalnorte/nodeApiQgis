import{J as M,i as C,k as Q,l as R,m as U,r as b,p as X,j as e,A as G,B as A,L as K,X as h,q as H,v as x,f as O,W as V,w as J,u as W,N as E,e as _,t as T}from"./index-BP-vK1Zn.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Z=M("tag",Y),ee=(r=1e3)=>new Promise(a=>setTimeout(a,r)),se=async r=>{if(!r)throw new Error("Id is required");if(r==="new")return{id:"new",title:"",price:0,description:"",slug:"",stock:0,sizes:[],gender:"men",tags:[],images:[]};const{data:a}=await C.get(`/products/${r}`),n=a.images.map(i=>i.includes("http")?i:`https://nodeintegracionsiesa-production.up.railway.app/api/files/product/${i}`);return{...a,images:n}},te=async r=>{await ee(1500);const{id:a,user:n,images:i=[],files:u=[],...d}=r,m=a==="new";d.stock=Number(d.stock||0),d.price=Number(d.price||0);const{data:c}=await C({url:m?"/products":`/products/${a}`,method:m?"POST":"PATCH",data:{...d}});return{...c}},re=r=>{const a=Q(),n=R({queryKey:["product",{id:r}],queryFn:()=>se(r),retry:!1,staleTime:1e3*60*5}),i=U({mutationFn:te,onSuccess:u=>{a.invalidateQueries({queryKey:["products"]}),a.invalidateQueries({queryKey:["product",{id:u.id}]}),a.setQueryData(["products",{id:u.id}],u)}});return{...n,mutation:i}},D=["XS","S","M","L","XL","XXL"],ae=({title:r,subTitle:a,product:n,onSubmit:i,isPending:u})=>{const[d,m]=b.useState(!1),{register:c,handleSubmit:f,formState:{errors:l},getValues:o,setValue:p,watch:j}=X({defaultValues:n}),N=b.useRef(null),[q,v]=b.useState([]);b.useEffect(()=>{v([])},[n]);const y=j("sizes"),L=j("tags"),g=j("stock"),P=()=>{const s=N.current.value;if(s==="")return;const t=new Set(o("tags"));t.add(s),p("tags",Array.from(t))},z=s=>{const t=new Set(o("tags"));t.delete(s),p("tags",Array.from(t))},I=s=>{const t=new Set(o("sizes"));t.add(s),p("sizes",Array.from(t))},F=s=>{const t=new Set(o("sizes"));t.delete(s),p("sizes",Array.from(t))},w=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?m(!0):s.type==="dragleave"&&m(!1)},$=s=>{s.preventDefault(),s.stopPropagation(),m(!1);const t=s.dataTransfer.files;if(!t)return;v(S=>[...S,...Array.from(t)]);const k=o("files")||[];p("files",[...k,...Array.from(t)])},B=s=>{const t=s.target.files;if(!t)return;v(S=>[...S,...Array.from(t)]);const k=o("files")||[];p("files",[...k,...Array.from(t)])};return e.jsxs("form",{onSubmit:f(i),children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(G,{title:r,subtitle:a}),e.jsxs("div",{className:"flex justify-end mb-10 gap-4",children:[e.jsx(A,{variant:"outline",type:"button",children:e.jsxs(K,{to:"/admin/products",className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),"Cancelar"]})}),e.jsxs(A,{type:"submit",disabled:u,children:[e.jsx(H,{className:"w-4 h-4"}),"Guardar cambios"]})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Información del producto"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Título del producto"}),e.jsx("input",{type:"text",...c("title",{required:!0}),className:x("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",{"border-red-500":l.title}),placeholder:"Título del producto"}),l.title&&e.jsx("p",{className:"text-red-500 text-sm",children:"El título es requerido"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Precio ($)"}),e.jsx("input",{type:"number",...c("price",{required:!0,min:1}),className:x("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",{"border-red-500":l.price}),placeholder:"Precio del producto"}),l.price&&e.jsx("p",{className:"text-red-500 text-sm",children:"El precio debe de ser mayor a 0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Stock del producto"}),e.jsx("input",{type:"number",...c("stock",{required:!0,min:1}),className:x("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",{"border-red-500":l.stock}),placeholder:"Stock del producto"}),l.stock&&e.jsx("p",{className:"text-red-500 text-sm",children:"El inventario debe de ser mayor a 0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Slug del producto"}),e.jsx("input",{type:"text",...c("slug",{required:!0,validate:s=>!/\s/.test(s)||"El slug no puede contener espacios en blanco"}),className:x("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",{"border-red-500":l.slug}),placeholder:"Slug del producto"}),l.slug&&e.jsx("p",{className:"text-red-500 text-sm",children:l.slug.message||"El slug es requerido."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Género del producto"}),e.jsxs("select",{...c("gender"),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"men",children:"Hombre"}),e.jsx("option",{value:"women",children:"Mujer"}),e.jsx("option",{value:"unisex",children:"Unisex"}),e.jsx("option",{value:"kids",children:"Niño"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Descripción del producto"}),e.jsx("textarea",{...c("description",{required:!0}),rows:5,className:x("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",{"border-red-500":l.description}),placeholder:"Descripción del producto"}),l.description&&e.jsx("p",{className:"text-red-500 text-sm",children:"La descripción es requerida."})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Tallas disponibles"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:D.map(s=>e.jsxs("span",{className:x("inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 border border-blue-200",{hidden:!y.includes(s)}),children:[s,e.jsx("button",{onClick:()=>F(s),className:"cursor-pointer ml-2 text-blue-600 hover:text-blue-800 transition-colors duration-200",children:e.jsx(h,{className:"h-3 w-3"})})]},s))}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-slate-200",children:[e.jsx("span",{className:"text-sm text-slate-600 mr-2",children:"Añadir tallas:"}),D.map(s=>e.jsx("button",{type:"button",onClick:()=>I(s),disabled:o("sizes").includes(s),className:`px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 ${y.includes(s)?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-slate-200 text-slate-700 hover:bg-slate-300 cursor-pointer"}`,children:s},s))]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Etiquetas"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(s=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 border border-green-200",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),s,e.jsx("button",{onClick:()=>z(s),className:"ml-2 text-green-600 hover:text-green-800 transition-colors duration-200",children:e.jsx(h,{className:"h-3 w-3"})})]},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:N,type:"text",onKeyDown:s=>{(s.key==="Enter"||s.key===" "||s.key===",")&&(s.preventDefault(),P(),N.current.value="")},placeholder:"Añadir nueva etiqueta...",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"}),e.jsx(A,{onClick:P,className:"px-4 py-2rounded-lg ",children:e.jsx(O,{className:"h-4 w-4"})})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Imágenes del producto"}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200 ${d?"border-blue-400 bg-blue-50":"border-slate-300 hover:border-slate-400"}`,onDragEnter:w,onDragLeave:w,onDragOver:w,onDrop:$,children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:B}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(V,{className:"mx-auto h-12 w-12 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-slate-700",children:"Arrastra las imágenes aquí"}),e.jsx("p",{className:"text-sm text-slate-500",children:"o haz clic para buscar"})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"PNG, JPG, WebP hasta 10MB cada una"})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700",children:"Imágenes actuales"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:n.images.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-square bg-slate-100 rounded-lg border border-slate-200 flex items-center justify-center",children:e.jsx("img",{src:s,alt:"Product",className:"w-full h-full object-cover rounded-lg"})}),e.jsx("button",{className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:e.jsx(h,{className:"h-3 w-3"})}),e.jsx("p",{className:"mt-1 text-xs text-slate-600 truncate",children:s})]},t))})]}),e.jsxs("div",{className:x("mt-6 space-y-3",{hidden:q.length===0}),children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700",children:"Imágenes por cargar"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:q.map((s,t)=>e.jsx("img",{src:URL.createObjectURL(s),alt:"Product",className:"w-full h-full object-cover rounded-lg"},t))})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Estado del producto"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Estado"}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Activo"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Inventario"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${g>5?"bg-green-100 text-green-800":g>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:g>5?"En stock":g>0?"Bajo stock":"Sin stock"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Imágenes"}),e.jsxs("span",{className:"text-sm text-slate-600",children:[n.images.length," imágenes"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Tallas disponibles"}),e.jsxs("span",{className:"text-sm text-slate-600",children:[y.length," tallas"]})]})]})]})]})]})})]})},ne=()=>{const{id:r}=J(),a=W(),{isLoading:n,isError:i,data:u,mutation:d}=re(r||""),m=r==="new"?"Nuevo producto":"Editar producto",c=r==="new"?"Aquí puedes crear un nuevo producto.":"Aquí puedes editar el producto.",f=async l=>{await d.mutateAsync(l,{onSuccess:o=>{T.success("Producto actualizado correctamente",{position:"top-right"}),a(`/admin/products/${o.id}`)},onError:o=>{console.log(o),T.error("Error al actualizar el producto")}})};return i?e.jsx(E,{to:"/admin/products"}):n?e.jsx(_,{}):u?e.jsx(ae,{title:m,subTitle:c,product:u,onSubmit:f,isPending:d.isPending}):e.jsx(E,{to:"/admin/products"})};export{ne as AdminProductPage,ne as default};
