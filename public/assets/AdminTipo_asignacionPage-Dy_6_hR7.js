import{i as N,k as _,u as v,l as w,m as b,n as C,t as x,o as m,p as E,b as S,j as e,e as f,A,B as p,L as q,X as D,q as P,T as I,s as O,v as y,w as B,N as j,r as k}from"./index-DsnDXHI_.js";import{a as F}from"./get-categoria_activo.action-DTUDhUua.js";const G=async a=>{const{id:i,files:o=[],...l}=a,n=i==="new";console.log("like in action create"),console.log({userLike:a});const{data:r}=await N({url:n?"/tipo_asignacion/":`/tipo_asignacion/${i}`,method:n?"POST":"PUT",data:{...l}});return{...r}},Q=async a=>{console.log(a);const{data:i}=await N({url:`/tipo_asignacion/${a}`,method:"DELETE"});return{...i}},$=a=>{const i=_(),o=v(),l=w({queryKey:["Tipo_asignacion",{id:a}],queryFn:()=>F(a),retry:!1,staleTime:1e3*60*.5}),n=b({mutationFn:G,onSuccess:t=>{i.invalidateQueries({queryKey:["Tipo_asignacions"]}),i.invalidateQueries({queryKey:["Tipo_asignacion"]})}}),r=b({mutationFn:Q,onSuccess:t=>{i.invalidateQueries({queryKey:["Tipo_asignacions"]}),o(-1),x.success("Se ha eliminado correctamente")},onError:t=>{console.error(t),x.error("Error al eliminar ubicación")}});return{...l,mutation:n,mutationDelete:r,handleSubmit:async t=>{event?.preventDefault(),console.log("onsubmit",t),await n.mutateAsync(t,{onSuccess:s=>{console.log({data:s});let c="Tipo_asignacion actualizada ";t.id==="new"&&(c="Tipo_asignacion Creada "),m.fire({title:"Exito",text:c,icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),o(`/admin/tipo_asignacion/${s.id}`)},onError:s=>{console.log(s),m.fire({title:"<b>Error al Guardar</b>",text:`${s?.response?.data?.error||s.message||"Error desconocido"}`,icon:"error"})}})},handleDelete:async t=>{(await C()).isConfirmed&&await r.mutateAsync(t,{onSuccess:c=>{m.fire({title:"Exito",text:"Se ha Eliminado Correctamente",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),o(`/admin/tipo_asignacion/${c.id}`)},onError:c=>{console.log(c),x.success("Error al Eliminar"),m.fire({title:"Error",text:"Error al Eliminar",icon:"error",confirmButtonColor:"#16a34a",background:"#1f2937",color:"#f9fafb"})}})}}},K=({title:a,subTitle:i,onSubmit:o,handleDelete:l,clase:n,isPending:r,isDeleting:u})=>{const{register:d,handleSubmit:t,formState:{errors:s},getValues:c,setValue:L,watch:U}=E({defaultValues:n}),h=S().pathname.split("/").filter(Boolean),T=h[h.length-1];let g=!1;return T==="new"&&(g=!0),r||u?e.jsx(f,{}):e.jsxs("form",{className:"py-0 pb-10",onSubmit:t(o),children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 flex flex-col gap-4",children:[e.jsx(A,{title:a,subtitle:i}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{variant:"outline",type:"button",children:e.jsxs(q,{to:"/admin/tipo_asignacion",className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Cancelar"]})}),e.jsxs(p,{type:"submit",disabled:r,children:[e.jsx(P,{className:"w-4 h-4"}),"Guardar"]}),!g&&e.jsxs(p,{onClick:()=>l(+n.id),variant:"destructive",type:"button",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 py-8",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Información de Tipo de Asignación"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:["Código",e.jsx("img",{src:O,alt:"Campo llave",className:"w-4 h-4 ml-2"})]})}),e.jsx("input",{readOnly:!g,type:"text",...d("COD_TIPO_ASIGNACION",{required:!0}),className:y("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":s.COD_TIPO_ASIGNACION}),placeholder:"Ingrese Código"}),s.COD_TIPO_ASIGNACION&&e.jsx("p",{className:"text-red-500 text-sm",children:"El Código es requerido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Detalle"}),e.jsx("input",{type:"text",...d("detalle",{required:!0}),className:y("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":s.detalle}),placeholder:"Nombre"}),s.detalle&&e.jsx("p",{className:"text-red-500 text-sm",children:"Detalle es requerida"})]})]})]})})})})]})},R=()=>{const{id:a}=B();v();const{isLoading:i,isError:o,data:l,mutation:n,mutationDelete:r,handleDelete:u,handleSubmit:d}=$(a||""),t=a==="new"?"Nuevo Tipo de asignación":"Editar Tipo de asignación",s=a==="new"?"Aquí puedes crear una nueva Tipo de asignación.":"Aquí puedes editar la Tipo_asignación.";return o?e.jsx(j,{to:"/admin/tipo_asignacion"}):i?e.jsx(f,{}):l?e.jsx(e.Fragment,{children:e.jsx(k.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(K,{title:t,subTitle:s,clase:l,onSubmit:d,handleDelete:u,isPending:n.isPending,isDeleting:r.isPending})})}):e.jsx(j,{to:"/admin/tipo_asignacion"})};export{R as AdminTipo_asignacionPage,R as default};
