import{i as h,k as C,u as v,l as E,m as y,n as A,t as g,o as m,p as M,b as S,j as e,e as p,A as q,B as f,L as D,X as P,q as B,T as k,s as T,v as j,w as F,N as w,r as O}from"./index-BAyxOqLx.js";const $=async a=>{if(!a)throw new Error("Id is required");if(a==="new")return console.log("llega a new"),{id:"new",COD_MARCA:"",detalle:""};const{data:r}=await h.get(`/marca/${a}`);return r},Q=async a=>{const{id:r,files:o=[],...i}=a,n=r==="new";console.log("like in action create"),console.log({userLike:a});const{data:l}=await h({url:n?"/marca/":`/marca/${r}`,method:n?"POST":"PUT",data:{...i}});return{...l}},R=async a=>{console.log(a);const{data:r}=await h({url:`/marca/${a}`,method:"DELETE"});return{...r}},I=a=>{const r=C(),o=v(),i=E({queryKey:["Marca",{id:a}],queryFn:()=>$(a),retry:!1,staleTime:1e3*60*.5}),n=y({mutationFn:Q,onSuccess:t=>{r.invalidateQueries({queryKey:["marcas"]}),r.invalidateQueries({queryKey:["marca"]})}}),l=y({mutationFn:R,onSuccess:t=>{r.invalidateQueries({queryKey:["marcas"]}),o(-1),g.success("Se ha eliminado correctamente")},onError:t=>{console.error(t),g.error("Error al eliminar ubicación")}});return{...i,mutation:n,mutationDelete:l,handleSubmit:async t=>{event?.preventDefault(),console.log("onsubmit",t),await n.mutateAsync(t,{onSuccess:s=>{console.log({data:s});let c="Marca actualizada ";t.id==="new"&&(c="Marca Creada "),m.fire({title:"Exito",text:c,icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),o(`/admin/marca/${s.id}`)},onError:s=>{console.log(s),m.fire({title:"<b>Error al Guardar</b>",text:`${s?.response?.data?.error||s.message||"Error desconocido"}`,icon:"error"})}})},handleDelete:async t=>{(await A()).isConfirmed&&await l.mutateAsync(t,{onSuccess:c=>{m.fire({title:"Exito",text:"Se ha Eliminado Correctamente",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),o(`/admin/marca/${c.id}`)},onError:c=>{console.log(c),g.success("Error al Eliminar"),m.fire({title:"Error",text:"Error al Eliminar",icon:"error",confirmButtonColor:"#16a34a",background:"#1f2937",color:"#f9fafb"})}})}}},K=({title:a,subTitle:r,onSubmit:o,handleDelete:i,clase:n,isPending:l,isDeleting:u})=>{const{register:d,handleSubmit:t,formState:{errors:s},getValues:c,setValue:L,watch:_}=M({defaultValues:n}),b=S().pathname.split("/").filter(Boolean),N=b[b.length-1];let x=!1;return N==="new"&&(x=!0),l||u?e.jsx(p,{}):e.jsxs("form",{className:"py-0 pb-10",onSubmit:t(o),children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 flex flex-col gap-4",children:[e.jsx(q,{title:a,subtitle:r}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{variant:"outline",type:"button",children:e.jsxs(D,{to:"/admin/Marca",className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),"Cancelar"]})}),e.jsxs(f,{type:"submit",disabled:l,children:[e.jsx(B,{className:"w-4 h-4"}),"Guardar"]}),!x&&e.jsxs(f,{onClick:()=>i(+n.id),variant:"destructive",type:"button",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 py-8",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Información de Marca"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:["Código",e.jsx("img",{src:T,alt:"Campo llave",className:"w-4 h-4 ml-2"})]})}),e.jsx("input",{readOnly:!x,type:"text",...d("COD_MARCA",{required:!0}),className:j("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":s.COD_MARCA}),placeholder:"Ingrese Código"}),s.COD_MARCA&&e.jsx("p",{className:"text-red-500 text-sm",children:"El Código es requerido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Detalle"}),e.jsx("input",{type:"text",...d("detalle",{required:!0}),className:j("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":s.detalle}),placeholder:"Nombre"}),s.detalle&&e.jsx("p",{className:"text-red-500 text-sm",children:"el Nombre de la Marca  es requerida"})]})]})]})})})})]})},V=()=>{const{id:a}=F();v();const{isLoading:r,isError:o,data:i,mutation:n,mutationDelete:l,handleDelete:u,handleSubmit:d}=I(a||""),t=a==="new"?"Nuevo Marca":"Editar Marca",s=a==="new"?"Aquí puedes crear una nueva Marca.":"Aquí puedes editar la Marca.";return o?e.jsx(w,{to:"/admin/marca"}):r?e.jsx(p,{}):i?e.jsx(e.Fragment,{children:e.jsx(O.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(K,{title:t,subTitle:s,clase:i,onSubmit:d,handleDelete:u,isPending:n.isPending,isDeleting:l.isPending})})}):e.jsx(w,{to:"/admin/marca"})};export{V as AdminMarcaPage,V as default};
