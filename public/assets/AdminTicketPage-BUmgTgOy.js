import{J as Se,i as Oe,k as me,u as se,b as ge,l as pe,r as f,m as re,n as ce,t as M,o as $,K as qe,M as Ae,Q as De,R as Pe,c as Be,j as e,e as P,h as V,y as Ee,U as _e,B as R,P as Ue,V as Fe,p as $e,a as Qe,A as Ke,L as de,X as k,q as ze,T as Me,s as Re,v as N,D as q,W as Ge,E as C,F as w,G as I,H as S,I as Le,w as He,N as ue}from"./index-BAyxOqLx.js";import{A as Je,a as We}from"./AdminAreasTable-DLTZ9xLk.js";import"./useUbicaciones-Cmrf9TGx.js";import"./useAreas-Cn68CKS2.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],Xe=Se("message-square-plus",Ve),Ye=async u=>{const{page:t,limit:i,offset:d,gender:a,sizes:p,minPrice:x,maxPrice:s,query:m}=u,{data:c}=await Oe.get("/auth/users/agentes/",{params:{page:t,limit:i,offset:d,gender:a,sizes:p,minPrice:x,maxPrice:s,q:m}});return console.log(c),c},Ze=u=>{const t=me(),i=se(),d=ge(),a=pe({queryKey:["Ticket"],queryFn:()=>Pe(u),retry:!1,staleTime:20*1e3}),[p,x]=f.useState([]),s=re({mutationFn:Ae,onSuccess:n=>{t.invalidateQueries({queryKey:["Tickets","TicketSummary","TicketsQueryInProgressUser",n.id]}),t.invalidateQueries({queryKey:["Ticket","TicketSummaryByUser",n.id]}),t.invalidateQueries({queryKey:["Ticket"]})}}),m=re({mutationFn:qe,onSuccess:n=>{t.invalidateQueries({queryKey:["Tickets","TicketSummary","TicketsQueryInProgressUser"]}),t.invalidateQueries({queryKey:["Ticket"]}),i(-1),M.success("Se ha eliminado correctamente")},onError:n=>{console.error(n),M.error("Error al eliminar ubicación")}}),c=re({mutationFn:De,onSuccess:n=>{t.invalidateQueries({queryKey:["Tickets","TicketSummary","TicketsQueryInProgressUser",u]}),t.invalidateQueries({queryKey:["Ticket","TicketSummaryByUser",u]})},onError:n=>{console.error(n),M.error("Error al eliminar")}});return{...a,mutation:s,mutationDelete:m,handleSubmit:async n=>{event?.preventDefault(),console.log("onsubmit",n),await s.mutateAsync(n,{onSuccess:y=>{t.invalidateQueries({queryKey:["Tickets","TicketSummary","TicketsQueryInProgressUser"]}),t.invalidateQueries({queryKey:["Ticket","TicketSummaryByUser"]}),console.log({data:y}),x([]),n.files=[];let v="Ticket actualizado ";n.id==="new"&&(v="Ticket Creado "),$.fire({title:"Exito",text:v,icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),console.log("location:",{location:d});let A=`/admin/ticket/${y.id||""}`;d.pathname.includes("pqr")&&(A="/pqr"),console.log({redirect:A}),i(`${A}`)},onError:y=>{console.log(y),$.fire({title:"<b>Error al Guardar</b>",text:`${y?.response?.data?.error||y.message||"Error desconocido"}`,icon:"error"})}})},handleDelete:async n=>{(await ce()).isConfirmed&&await m.mutateAsync(n,{onSuccess:v=>{t.invalidateQueries({queryKey:["Tickets","TicketSummary","TicketsQueryInProgressUser",n]}),t.invalidateQueries({queryKey:["Ticket","TicketSummaryByUser",n]}),$.fire({title:"Exito",text:"Se ha Eliminado Correctamente",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),i(`/admin/ticket/${v.id}`)},onError:v=>{console.log(v),M.success("Error al Eliminar"),$.fire({title:"Error",text:"Error al Eliminar",icon:"error",confirmButtonColor:"#16a34a",background:"#1f2937",color:"#f9fafb"})}})},files:p,setFiles:x,handleDeleteImage:async n=>{console.log("clic en borrar imagen "+n),(await ce()).isConfirmed&&await c.mutateAsync(n,{onSuccess:v=>{t.invalidateQueries({queryKey:["Tickets","TicketSummary","TicketsQueryInProgressUser"]}),t.invalidateQueries({queryKey:["Ticket","TicketSummaryByUser"]}),t.invalidateQueries({queryKey:["Ticket"]}),$.fire({title:"Exito",text:"Se ha Eliminado Correctamente",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),i(d.pathname,{replace:!0})},onError:v=>{t.invalidateQueries({queryKey:["Tickets","TicketSummary","TicketsQueryInProgressUser"]}),t.invalidateQueries({queryKey:["Ticket","TicketSummaryByUser"]}),console.log(v),M.success("Error al Eliminar"),$.fire({title:"Error",text:"Error al Eliminar",icon:"error",confirmButtonColor:"#16a34a",background:"#1f2937",color:"#f9fafb"})}})}}},er=()=>{const u=me(),[t]=Be(),i=t.get("query")||void 0,d=t.get("limit")||9,a=t.get("page")||1;return{...pe({queryKey:["usersAgente",{limit:d,page:a,query:i}],queryFn:()=>Ye({limit:isNaN(+d)?9:+d,page:+a,query:i}),staleTime:1e3*60*.5}),invalidate:()=>u.invalidateQueries({queryKey:["Tickets","usersAgente"]})}},rr=({userId:u,setOpenModal:t,setValue:i,handleSelectItem:d})=>{const{data:a,isPending:p,isFetching:x,isLoading:s}=er();console.log({data:a});const m=[{header:"CODIGO",accessorKey:"CODIGO"},{header:"Nombre",accessorFn:c=>c.lastname+" "+c.name||null}];return p||s||x?e.jsx(P,{}):e.jsx(e.Fragment,{children:e.jsx("div",{children:e.jsx(V,{data:a?.data||[],columns:m,userId:u,onPermissionChange:d,mostrarBoton:!1})})})},sr=({userId:u,setOpenModal:t,setValue:i})=>{const{data:d,isPending:a,isFetching:p,isLoading:x}=Ee();console.log({data:d});const s=async c=>(console.log("llega al CategorAdminUsersTableTicket"),console.log({updated:c}),console.log(c.row.id),t(!1),i("usuarioId",c.row.id),i("usuario.name",c.row.name),i("usuario.lastname",c.row.lastname),i("usuario.CODIGO",c.row.CODIGO),!0),m=[{header:"CODIGO",accessorKey:"CODIGO"},{header:"RESPONSABLE",accessorFn:c=>c.lastname+" "+c.name||null}];return a||x||p?e.jsx(P,{}):e.jsx(e.Fragment,{children:e.jsx("div",{children:e.jsx(V,{data:d?.data||[],columns:m,userId:u,onPermissionChange:s,mostrarBoton:!1})})})},tr=({userId:u,setOpenModal:t,setValue:i,handleSelectItem:d})=>{const{data:a,isPending:p,isFetching:x,isLoading:s}=_e();console.log({data:a});const m=[{header:"Descripcion",accessorKey:"detalle"}];return p||s||x?e.jsx(P,{}):e.jsx(e.Fragment,{children:e.jsx("div",{children:e.jsx(V,{data:a?.data||[],columns:m,userId:u,onPermissionChange:d,mostrarBoton:!1})})})},ar=({dir:u,data:t,edit:i})=>{console.log({data:t});function d(s){return s?typeof s=="string"?s.slice(0,10):s.toISOString().slice(0,10):""}function a(s){return s.replace(/\w\S*/g,m=>m.charAt(0).toUpperCase()+m.substring(1).toLowerCase())}const p=se(),x=s=>{p(`/admin/ticket_mensaje/${s}`)};return e.jsx("div",{className:"relative border-l-2 border-gray-300 pl-8 space-y-10",children:t?.map((s,m)=>e.jsx("div",{children:e.jsx("div",{className:"space-y-6 mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-11 top-0 my-0 flex items-center space-x-0 p-0 rounded-lg  transition-colors",children:e.jsx("div",{className:`w-13 h-13 bg-gradient-to-br  rounded-full flex items-center justify-center text-white font-semibold
                                        ${s.user?.role==="admin"?"bg-gradient-to-br from-red-400 to-red-800":"bg-gradient-to-br from-green-400 to-green-700"}                                        
                                        `,children:a(s.user?.name.substring(0,2)||""+s.user?.role||"")})}),e.jsxs("div",{className:"bg-white shadow rounded p-4 border",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-semibold",children:[a(s.user?.lastname||"")," ",a(s.user?.name||"")]}),i&&e.jsxs(R,{type:"button",onClick:()=>x(s.id),className:`inline-flex items-center gap-1 px-3 py-1.5 \r
                                            bg-green-50 text-green-700 rounded-md border border-green-200 \r
                                            hover:bg-green-100 hover:border-green-300 \r
                                                transition-all duration-200`,children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{children:"Editar"})]})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[" ",d(s.fecha)," ",s.hora]}),s.userId&&e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:s.mensaje}),e.jsx("br",{}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:s.images.map((c,T)=>e.jsx("div",{className:"relative  group",children:e.jsx("img",{onClick:()=>{},src:`${c.url}`,alt:"Product",className:"cursor-pointer object-cover shadow-lg rounded-lg bg-white rounded-xl shadow-lg border border-slate-200 p-6"})},T))}),s&&e.jsx("div",{className:"flex gap-2 mt-3",children:e.jsx("button",{className:"text-white px-3 py-1 text-sm rounded ",children:"Editar"})})]})]},m)})},m))})},lr=({userId:u,setOpenModal:t,handleSelectItem:i,setValue:d})=>{const{data:a,isPending:p,isFetching:x,isLoading:s}=Fe();console.log({data:a});const m=[{header:"Descripcion",accessorKey:"detalle"}];return p||s||x?e.jsx(P,{}):e.jsx(e.Fragment,{children:e.jsx("div",{children:e.jsx(V,{data:a?.data||[],columns:m,userId:u,onPermissionChange:i,mostrarBoton:!1})})})},or=({title:u,subTitle:t,onSubmit:i,handleDelete:d,clase:a,isPending:p,isDeleting:x,openModal:s,setOpenModal:m,openModalActivo:c,setOpenModalActivo:T,openModalUser:Q,setOpenModalUser:B,openModalAgente:n,setOpenModalAgente:y,openModalSucursal:v,setOpenModalSucursal:A,openModalArea:G,setOpenModalArea:K,openModalTipo:L,setOpenModalTipo:E,openModalUbicacion:_,setOpenModalUbicacion:z,openModalEstado:H,setOpenModalEstado:U,files:J,setFiles:W,handleDeleteImage:X})=>{const{register:b,handleSubmit:Y,formState:{errors:g},getValues:te,setValue:l,reset:xe,watch:h}=$e({defaultValues:a}),{user:j,logout:nr}=Qe();f.useEffect(()=>{const r=new Date,o=r.toISOString().split("T")[0],D=r.toTimeString().slice(0,5);console.log(o,D);const F=le.pathname.split("/").filter(Boolean);F[F.length-1]==="new"&&xe({...a,fechaFormatted:o,hora:D,usuarioId:parseInt(j.id)||void 0,usuario:j,estadoTicketId:1})},[]),console.log("initialvalues"),console.log({initialValues:a});const he=async r=>{console.log("llega al  Select Activo enTicketForm"),console.log({updated:r}),console.log("hacer peticion http."),l("activoId",r.row.id),l("activo.nombre_activo",r.row.nombre_activo),l("activo.COD_ACTIVO",r.row.COD_ACTIVO);const o=r.row.Activo_asignacion[0]||null;return o&&(console.log("activo asigonacion no es null"),l("sucursalId",o.sucursalId),l("sucursal.detalle",o.sucursal.detalle),l("sucursal.COD_SUCURSAL",o.sucursal.COD_SUCURSAL),l("ubicacionId",o.ubicacionId),l("ubicacion.detalle",o.ubicacion.detalle),l("ubicacion.COD_UBICACION",o.ubicacion.COD_UBICACION),l("areaId",o.areaId),l("area.detalle",o.area.detalle),l("area.COD_AREA",o.area.COD_AREA)),console.log(r.row.id),T(!1),!0},be=async r=>{const o=r.row;return console.log("llega al EstadoTickets"),console.log({updated:r}),console.log(r.row.id),l("estadoTicketId",+o.id),l("estado_ticket.id",o.id),l("estado_ticket.detalle",o.detalle),U(!1),!0},ye=async r=>(console.log("llega al Ticket_tipo"),console.log({updated:r}),console.log(r.row.id),l("ticket_tipoId",r.row.id),l("ticket_Tipo.id",r.row.id),l("ticket_Tipo.COD_TICKET_TIPO",r.row.COD_TICKET_TIPO),l("ticket_Tipo.detalle",r.row.detalle),E(!1),!0),fe=async r=>(console.log("llega al AgentesTable desde TicketForm"),console.log({updated:r}),console.log(r.row.id),y(!1),l("agenteId",r.row.id),l("agente.name",r.row.name),l("agente.lastname",r.row.lastname),l("agente.CODIGO",r.row.CODIGO),!0),[je,Z]=f.useState(!1),[ve,Ne]=f.useState(""),[ke,ae]=f.useState(!1),ee=r=>{r.preventDefault(),r.stopPropagation(),r.type==="dragenter"||r.type==="dragover"?Z(!0):r.type==="dragleave"&&Z(!1)},Te=r=>{r.preventDefault(),r.stopPropagation(),Z(!1);const o=r.dataTransfer.files;if(!o)return;W(F=>[...F,...Array.from(o)]);const D=te("files")||[];l("files",[...D,...Array.from(o)])},Ce=r=>{const o=r.target.files;if(!o)return;W(F=>[...F,...Array.from(o)]);const D=te("files")||[];l("files",[...D,...Array.from(o)]),console.log(D)},le=ge(),oe=le.pathname.split("/").filter(Boolean),we=oe[oe.length-1];console.log("initialvalues"),console.log({initialValues:a});const ne=(a?.images??[]).map(r=>typeof r=="string"?{url:r}:r);console.log("imagenes:");const Ie="http://localhost:3000/api/images/ticket";let ie=!1;we==="new"&&(ie=!0);const O=r=>{l(r,null)};return p||x?e.jsx(P,{}):e.jsxs("form",{className:"py-0 pb-10",onSubmit:Y(i),children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 flex flex-col gap-4",children:[e.jsx(Ke,{title:u,subtitle:t}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{variant:"outline",type:"button",children:e.jsxs(de,{to:j?.role=="admin"?"/admin/ticket":"/pqr",className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Cancelar"]})}),e.jsxs(R,{type:"submit",disabled:p,children:[e.jsx(ze,{className:"w-4 h-4"}),"Guardar"]}),!ie&&e.jsxs(R,{onClick:()=>d(+a.id),variant:"destructive",type:"button",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Información de Tickets"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:["ID",e.jsx("img",{src:Re,alt:"Campo llave",className:"w-4 h-4 ml-2"})]})}),e.jsx("input",{readOnly:!0,type:"text",...b("id",{required:!0}),className:N("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":g.id}),placeholder:"Ingrese Código"}),g.id&&e.jsx("p",{className:"text-red-500 text-sm",children:"* requerido"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsx("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:"Fecha"})}),e.jsx("input",{type:"date",readOnly:j?.role!="admin",...b("fechaFormatted",{required:!1}),className:N("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":g.fecha}),placeholder:"Ingrese Código"}),g.fecha&&e.jsx("p",{className:"text-red-500 text-sm",children:"Fecha es requerida"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsx("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:"Hora"})}),e.jsx("input",{type:"time",readOnly:j?.role!="admin",...b("hora",{required:!1}),className:N("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":g.hora}),placeholder:"Ingrese Hora"}),g.hora&&e.jsx("p",{className:"text-red-500 text-sm",children:"* requerido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Título"}),e.jsx("input",{type:"text",...b("titulo",{required:!0}),className:N("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":g.titulo}),placeholder:"Titulo"}),g.titulo&&e.jsx("p",{className:"text-red-500 text-sm",children:"* Requerido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Descripción Detallada"}),e.jsx("textarea",{rows:4,...b("obser",{required:!0}),className:N("resize-none w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":g.obser}),placeholder:"Descripción Detallada "}),g.obser&&e.jsx("p",{className:"text-red-500 text-sm",children:"* requerido"})]}),e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Estado del Ticket"}),e.jsxs("div",{className:"py-2  pb-2 relative",children:[e.jsx("input",{type:"hidden",...b("estadoTicketId",{required:!0}),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",readOnly:!0,value:`${h("estado_ticket.id")||""} - ${h("estado_ticket.detalle")||""}`,placeholder:"Buscar...",className:N("w-full pl-4 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",g.usuarioId?"border-red-500":"border-gray-300")}),e.jsx("button",{onClick:()=>{U(!0),console.log(open),console.log("clic")},type:"button",className:"absolute right-11 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-s-full p-2 cursor-pointer transition-colors",children:e.jsx(q,{size:18})}),e.jsx("button",{onClick:()=>O("usuarioId"),type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-e-full p-2 cursor-pointer transition-colors",children:e.jsx(k,{size:18})})]}),g.usuarioId&&e.jsx("p",{className:"text-red-500 text-sm",children:"Requerido"}),e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Usuario"}),e.jsxs("div",{className:"py-2  pb-2 relative",children:[e.jsx("input",{type:"hidden",...b("usuarioId",{required:!0}),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",readOnly:!0,value:`${h("usuario.CODIGO")||""} - ${h("usuario.name")||""} ${h("usuario.lastname")||""}`,placeholder:"Buscar...",className:N("w-full pl-4 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",g.usuarioId?"border-red-500":"border-gray-300")}),j?.role==="admin"&&e.jsx("button",{onClick:()=>{B(!0),console.log(open),console.log("clic")},type:"button",className:"absolute right-11 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-s-full p-2 cursor-pointer transition-colors",children:e.jsx(q,{size:18})}),j?.role==="admin"&&e.jsx("button",{onClick:()=>O("usuarioId"),type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-e-full p-2 cursor-pointer transition-colors",children:e.jsx(k,{size:18})})]}),g.usuarioId&&e.jsx("p",{className:"text-red-500 text-sm",children:"Requerido"}),e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Activo"}),e.jsxs("div",{className:"py-2  pb-2 relative",children:[e.jsx("input",{type:"hidden",...b("activoId",{required:!0}),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",readOnly:!0,value:`${h("activo.COD_ACTIVO")||""} - ${h("activo.nombre_activo")||""} `,required:!0,placeholder:"Buscar...",className:N("w-full pl-4 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",g.activoId?"border-red-500":"border-gray-300")}),e.jsx("button",{onClick:()=>{T(!0),console.log(open),console.log("clic")},type:"button",className:"absolute right-11 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-s-full p-2 cursor-pointer transition-colors",children:e.jsx(q,{size:18})}),e.jsx("button",{onClick:()=>O("activoId"),type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-e-full p-2 cursor-pointer transition-colors",children:e.jsx(k,{size:18})})]}),e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Sucursal"}),e.jsxs("div",{className:"py-2  pb-2 relative",children:[e.jsx("input",{type:"hidden",...b("sucursalId",{required:!1}),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",readOnly:!0,value:`${h("sucursal.COD_SUCURSAL")||""} - ${h("sucursal.detalle")||""} `,placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{onClick:()=>{A(!0)},type:"button",className:"absolute right-11 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-s-full p-2 cursor-pointer transition-colors",children:e.jsx(q,{size:18})}),e.jsx("button",{onClick:()=>O("sucursalId"),type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-e-full p-2 cursor-pointer transition-colors",children:e.jsx(k,{size:18})})]}),e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Ubicación"}),e.jsxs("div",{className:"py-2  pb-2 relative",children:[e.jsx("input",{type:"hidden",...b("ubicacionId",{required:!1}),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",readOnly:!0,value:`${h("ubicacion.COD_UBICACION")||""} - ${h("ubicacion.detalle")||""} `,placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{onClick:()=>{z(!0),console.log(open),console.log("clic")},type:"button",className:"absolute right-11 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-s-full p-2 cursor-pointer transition-colors",children:e.jsx(q,{size:18})}),e.jsx("button",{onClick:()=>O("ubicacionId"),type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-e-full p-2 cursor-pointer transition-colors",children:e.jsx(k,{size:18})})]}),e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Área"}),e.jsxs("div",{className:"py-2  pb-2 relative",children:[e.jsx("input",{type:"hidden",...b("areaId",{required:!1}),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",readOnly:!0,value:`${h("area.COD_AREA")||""} - ${h("area.detalle")||""} `,placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),j?.role==="admin"&&e.jsx("button",{onClick:()=>{K(!0),console.log(open),console.log("clic")},type:"button",className:"absolute right-11 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-s-full p-2 cursor-pointer transition-colors",children:e.jsx(q,{size:18})}),j?.role==="admin"&&e.jsx("button",{onClick:()=>O("areaId"),type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-e-full p-2 cursor-pointer transition-colors",children:e.jsx(k,{size:18})})]}),e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Agente de Soporte Técnico"}),e.jsxs("div",{className:"py-2  pb-2 relative",children:[e.jsx("input",{type:"hidden",...b("agenteId",{required:!1}),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",readOnly:!0,value:`${h("agente.CODIGO")||""} - ${h("agente.name")||""} ${h("agente.lastname")||""}`,placeholder:"Buscar...",className:N("w-full pl-4 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",g.agenteId?"border-red-500":"border-gray-300")}),j?.role==="admin"&&e.jsx("button",{onClick:()=>{y(!0),console.log(open),console.log("clic")},type:"button",className:"absolute right-11 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-s-full p-2 cursor-pointer transition-colors",children:e.jsx(q,{size:18})}),j?.role==="admin"&&e.jsx("button",{onClick:()=>O("agenteId"),type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-e-full p-2 cursor-pointer transition-colors",children:e.jsx(k,{size:18})})]}),g.usuarioId&&e.jsx("p",{className:"text-red-500 text-sm",children:"Requerido"}),e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Tipo de Mantenimiento"}),e.jsxs("div",{className:"py-2  pb-2 relative",children:[e.jsx("input",{type:"hidden",...b("ticket_tipoId",{required:!1}),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",readOnly:!0,value:`${h("ticket_Tipo.COD_TICKET_TIPO")||""} - ${h("ticket_Tipo.detalle")||""} `,placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{onClick:()=>{E(!0)},type:"button",className:"absolute right-11 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-s-full p-2 cursor-pointer transition-colors",children:e.jsx(q,{size:18})}),e.jsx("button",{onClick:()=>O("ticket_tipoId"),type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-e-full p-2 cursor-pointer transition-colors",children:e.jsx(k,{size:18})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Resúmen del Trabajo Realizado"}),e.jsx("textarea",{rows:4,...b("resumen",{required:!1}),className:N("resize-none w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":g.resumen}),placeholder:"Resumen Detallado"}),g.resumen&&e.jsx("p",{className:"text-red-500 text-sm",children:"* requerido"})]})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Imágenes del Ticket"}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200 ${je?"border-blue-400 bg-blue-50":"border-slate-300 hover:border-slate-400"}`,onDragEnter:ee,onDragLeave:ee,onDragOver:ee,onDrop:Te,children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:Ce}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ge,{className:"mx-auto h-12 w-12 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-slate-700",children:"Arrastra las imágenes aquí"}),e.jsx("p",{className:"text-sm text-slate-500",children:"o haz clic para buscar"})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"PNG, JPG, WebP hasta 10MB cada una"})]})]}),e.jsxs("div",{className:N("mt-6 space-y-3",{hidden:ne.length===0}),children:["                ",e.jsx("h3",{className:"text-sm font-medium text-slate-700",children:"Imágenes actuales"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:ne.map((r,o)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-square shadow-lg border-2 bg-slate-100 rounded-lg  border-slate-200 flex items-center justify-center",children:e.jsx("img",{onClick:()=>{Ne(`${r.url}`),ae(!0)},src:`${r.url}`,alt:"Product",className:"cursor-pointer w-full h-full object-cover rounded-lg"})}),e.jsx("button",{type:"button",title:"Quitar Imagen",onClick:()=>X(r.id),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:e.jsx(k,{className:"h-4 w-4"})}),e.jsxs("p",{className:"mt-1 text-xs text-slate-600 truncate",children:[r.url,"`"]})]},o))})]}),e.jsxs("div",{className:N("mt-6 space-y-3",{hidden:J.length===0}),children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700",children:"Imágenes por cargar"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:J.map((r,o)=>e.jsx("img",{src:URL.createObjectURL(r),alt:"Product",className:"w-full h-full object-cover rounded-lg"},o))})]})]})})]})}),e.jsx(C,{open:s,onOpenChange:m,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Búsqueda de Prioridad"})}),e.jsx("div",{})]})}),e.jsx(C,{open:c,onOpenChange:T,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Seleccionar Activo"})}),e.jsx("div",{className:"flex-1 overflow-auto mt-2",children:e.jsx(Le,{openModal:c,setOpenModal:T,handleSelectItem:he,setValue:l})})]})}),e.jsx(C,{open:Q,onOpenChange:B,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Seleccione Usuario"})}),e.jsx("div",{children:e.jsx(sr,{openModal:Q,setOpenModal:B,setValue:l})})]})}),e.jsx(C,{open:H,onOpenChange:U,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Seleccione "})}),e.jsx("div",{children:e.jsx(tr,{openModal:H,setOpenModal:U,handleSelectItem:be,setValue:l})})]})}),e.jsx(C,{open:n,onOpenChange:y,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Seleccione Agente de Soporte"})}),e.jsx("div",{children:e.jsx(rr,{openModal:n,setOpenModal:y,handleSelectItem:fe,setValue:l})})]})}),e.jsx(C,{open:_,onOpenChange:z,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Seleccione Ubicación"})}),e.jsx("div",{children:e.jsx(Je,{openModal:_,setOpenModal:z,setValue:l})})]})}),e.jsx(C,{open:G,onOpenChange:K,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Seleccione Área"})}),e.jsx("div",{children:e.jsx(We,{openModal:G,setOpenModal:K,setValue:l})})]})}),e.jsx(C,{open:L,onOpenChange:E,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Seleccione Tipo"})}),e.jsx("div",{children:e.jsx(lr,{openModal:L,setOpenModal:E,handleSelectItem:ye,setValue:l})})]})}),e.jsx(C,{open:ke,onOpenChange:ae,children:e.jsxs(w,{children:[e.jsx(I,{children:e.jsx(S,{children:"Imagen"})}),e.jsx("div",{children:e.jsx("div",{className:"flex items-center gap-1 shadow-lg border-2",children:e.jsx("img",{src:ve,alt:"Vista previa",className:"rounded-lg shadow-lg"})})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Chat"}),e.jsx(R,{variant:"outline",type:"button",children:e.jsxs(de,{to:j?.role=="admin"?`/admin/ticket_mensaje/new?ticket=${a.id}`:`/pqr/ticket_mensaje/new?ticket=${a.id}`,className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Crear Nuevo Mensaje"]})}),e.jsx(ar,{edit:j?.role=="admin",dir:Ie,data:a.ticket_mensajes||[]})]})})]})},gr=()=>{const{id:u}=He();se();const[t,i]=f.useState(!1),[d,a]=f.useState(!1),[p,x]=f.useState(!1),[s,m]=f.useState(!1),[c,T]=f.useState(!1),[Q,B]=f.useState(!1),[n,y]=f.useState(!1),[v,A]=f.useState(!1),[G,K]=f.useState(!1),{isLoading:L,isError:E,data:_,mutation:z,mutationDelete:H,handleDelete:U,handleSubmit:J,files:W,setFiles:X,handleDeleteImage:b}=Ze(u||""),Y=u==="new"?"Nuevo Ticket":"Editar Ticket",g=u==="new"?"Aquí puedes crear un nuevo Ticket.":"Aquí puedes editar el Ticket";return E?e.jsx(ue,{to:"/admin/ticket"}):L?e.jsx(P,{}):_?(console.log(_),e.jsx(e.Fragment,{children:e.jsx(f.Suspense,{fallback:e.jsx(P,{}),children:e.jsx(or,{title:Y,subTitle:g,clase:_,onSubmit:J,handleDelete:U,isPending:z.isPending,isDeleting:H.isPending,openModal:t,setOpenModal:i,openModalUser:Q,setOpenModalUser:B,openModalActivo:n,setOpenModalActivo:y,openModalTipo:p,setOpenModalTipo:x,openModalArea:d,setOpenModalArea:a,openModalUbicacion:s,setOpenModalUbicacion:m,openModalAgente:c,setOpenModalAgente:T,openModalSucursal:G,setOpenModalSucursal:K,files:W,setFiles:X,handleDeleteImage:b,openModalEstado:v,setOpenModalEstado:A})})})):e.jsx(ue,{to:"/admin/ticket"})};export{gr as AdminTicketPage,gr as default};
