import{i as h,k as N,u as w,l as E,m as y,n as S,t as x,o as m,p as A,b as q,j as e,e as p,A as D,B as f,L as O,X as P,q as B,T as k,s as T,v as C,w as F,N as j,r as G}from"./index-BwH_Ncr2.js";const $=async a=>{if(!a)throw new Error("Id is required");if(a==="new")return console.log("llega a new"),{id:"new",COD_CARGO:"",detalle:""};const{data:r}=await h.get(`/cargo/${a}`);return r},Q=async a=>{const{id:r,files:l=[],...i}=a,o=r==="new";console.log("like in action create"),console.log({userLike:a});const{data:n}=await h({url:o?"/cargo/":`/cargo/${r}`,method:o?"POST":"PUT",data:{...i}});return{...n}},R=async a=>{console.log(a);const{data:r}=await h({url:`/cargo/${a}`,method:"DELETE"});return{...r}},I=a=>{const r=N(),l=w(),i=E({queryKey:["cargo",{id:a}],queryFn:()=>$(a),retry:!1,staleTime:1e3*60*.5}),o=y({mutationFn:Q,onSuccess:t=>{r.invalidateQueries({queryKey:["cargos"]}),r.invalidateQueries({queryKey:["cargo"]})}}),n=y({mutationFn:R,onSuccess:t=>{r.invalidateQueries({queryKey:["cargos"]}),l(-1),x.success("Se ha eliminado correctamente")},onError:t=>{console.error(t),x.error("Error al eliminar ubicación")}});return{...i,mutation:o,mutationDelete:n,handleSubmit:async t=>{event?.preventDefault(),console.log("onsubmit",t),await o.mutateAsync(t,{onSuccess:s=>{console.log({data:s});let c="Cargo actualizado ";t.id==="new"&&(c="Cargo Creado "),m.fire({title:"Exito",text:c,icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),l(`/admin/cargo/${s.id}`)},onError:s=>{console.log(s),m.fire({title:"<b>Error al Guardar</b>",text:`${s?.response?.data?.error||s.message||"Error desconocido"}`,icon:"error"})}})},handleDelete:async t=>{(await S()).isConfirmed&&await n.mutateAsync(t,{onSuccess:c=>{m.fire({title:"Exito",text:"Se ha Eliminado Correctamente",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),l(`/admin/cargo/${c.id}`)},onError:c=>{console.log(c),x.success("Error al Eliminar"),m.fire({title:"Error",text:"Error al Eliminar",icon:"error",confirmButtonColor:"#16a34a",background:"#1f2937",color:"#f9fafb"})}})}}},K=({title:a,subTitle:r,onSubmit:l,handleDelete:i,clase:o,isPending:n,isDeleting:u})=>{const{register:d,handleSubmit:t,formState:{errors:s},getValues:c,setValue:L,watch:_}=A({defaultValues:o}),b=q().pathname.split("/").filter(Boolean),v=b[b.length-1];let g=!1;return v==="new"&&(g=!0),n||u?e.jsx(p,{}):e.jsxs("form",{className:"py-0 pb-10",onSubmit:t(l),children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 flex flex-col gap-4",children:[e.jsx(D,{title:a,subtitle:r}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{variant:"outline",type:"button",children:e.jsxs(O,{to:"/admin/cargo",className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),"Cancelar"]})}),e.jsxs(f,{type:"submit",disabled:n,children:[e.jsx(B,{className:"w-4 h-4"}),"Guardar"]}),!g&&e.jsxs(f,{onClick:()=>i(+o.id),variant:"destructive",type:"button",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 py-8",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Información de Cargo"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:["Código",e.jsx("img",{src:T,alt:"Campo llave",className:"w-4 h-4 ml-2"})]})}),e.jsx("input",{readOnly:!g,type:"text",...d("COD_CARGO",{required:!0}),className:C("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":s.COD_CARGO}),placeholder:"Ingrese Código"}),s.COD_CARGO&&e.jsx("p",{className:"text-red-500 text-sm",children:"El Código es requerido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Detalle"}),e.jsx("input",{type:"text",...d("detalle",{required:!0}),className:C("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":s.detalle}),placeholder:"Nombre"}),s.detalle&&e.jsx("p",{className:"text-red-500 text-sm",children:"el Nombre de la Cargo  es requerida"})]})]})]})})})})]})},z=()=>{const{id:a}=F();w();const{isLoading:r,isError:l,data:i,mutation:o,mutationDelete:n,handleDelete:u,handleSubmit:d}=I(a||""),t=a==="new"?"Nuevo Cargo":"Editar Cargo",s=a==="new"?"Aquí puedes crear un nuevo Cargo.":"Aquí puedes editar el Cargo.";return l?e.jsx(j,{to:"/admin/cargo"}):r?e.jsx(p,{}):i?e.jsx(e.Fragment,{children:e.jsx(G.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(K,{title:t,subTitle:s,clase:i,onSubmit:d,handleDelete:u,isPending:o.isPending,isDeleting:n.isPending})})}):e.jsx(j,{to:"/admin/cargo"})};export{z as AdminCargoPage,z as default};
