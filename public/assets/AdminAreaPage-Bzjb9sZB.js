import{i as h,k as E,u as v,l as N,m as b,n as C,t as g,o as m,p as S,b as q,j as e,e as p,A as D,B as f,L as P,X as B,q as Q,T,s as k,v as j,w as F,N as A,r as K}from"./index-DZARsHZ9.js";const O=async a=>{if(!a)throw new Error("Id is required");if(a==="new")return console.log("llega a new"),{id:"new",COD_AREA:"",detalle:""};const{data:r}=await h.get(`/Area/${a}`);return r},$=async a=>{const{id:r,files:i=[],...o}=a,n=r==="new",{data:l}=await h({url:n?"/area/":`/area/${r}`,method:n?"POST":"PUT",data:{...o}});return{...l}},R=async a=>{console.log(a);const{data:r}=await h({url:`/area/${a}`,method:"DELETE"});return{...r}},I=a=>{const r=E(),i=v(),o=N({queryKey:["area",{id:a}],queryFn:()=>O(a),retry:!1,staleTime:1e3*60*.5}),n=b({mutationFn:$,onSuccess:t=>{r.invalidateQueries({queryKey:["areas"]}),r.invalidateQueries({queryKey:["area"]})}}),l=b({mutationFn:R,onSuccess:t=>{r.invalidateQueries({queryKey:["areas"]}),r.invalidateQueries({queryKey:["area"]}),i(-1),g.success("Se ha eliminado correctamente")},onError:t=>{console.error(t),g.error("Error al eliminar ubicación")}});return{...o,mutation:n,mutationDelete:l,handleSubmit:async t=>{event?.preventDefault(),console.log("onsubmit",t),await n.mutateAsync(t,{onSuccess:s=>{r.invalidateQueries({queryKey:["areas"]}),r.invalidateQueries({queryKey:["area"]}),console.log({data:s});let c="Area actualizada ";t.id==="new"&&(c="Area Creada "),m.fire({title:"Exito",text:c,icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),i(`/admin/area/${s.id}`)},onError:s=>{console.log(s),m.fire({title:"<b>Error al Guardar</b>",text:`${s?.response?.data?.error||s.message||"Error desconocido"}`,icon:"error"})}})},handleDelete:async t=>{(await C()).isConfirmed&&await l.mutateAsync(t,{onSuccess:c=>{m.fire({title:"Exito",text:"Se ha Eliminado Correctamente",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),i(`/admin/area/${c.id}`)},onError:c=>{console.log(c),g.success("Error al Eliminar"),m.fire({title:"Error",text:"Error al Eliminar",icon:"error",confirmButtonColor:"#16a34a",background:"#1f2937",color:"#f9fafb"})}})}}},L=({title:a,subTitle:r,onSubmit:i,handleDelete:o,clase:n,isPending:l,isDeleting:u})=>{const{register:d,handleSubmit:t,formState:{errors:s},getValues:c,setValue:_,watch:G}=S({defaultValues:n}),y=q().pathname.split("/").filter(Boolean),w=y[y.length-1];let x=!1;return w==="new"&&(x=!0),l||u?e.jsx(p,{}):e.jsxs("form",{className:"py-0 pb-10",onSubmit:t(i),children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 flex flex-col gap-4",children:[e.jsx(D,{title:a,subtitle:r}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{variant:"outline",type:"button",children:e.jsxs(P,{to:"/admin/area",className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Cancelar"]})}),e.jsxs(f,{type:"submit",disabled:l,children:[e.jsx(Q,{className:"w-4 h-4"}),"Guardar"]}),!x&&e.jsxs(f,{onClick:()=>o(+n.id),variant:"destructive",type:"button",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 py-8",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Información de Area"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:["Código",e.jsx("img",{src:k,alt:"Campo llave",className:"w-4 h-4 ml-2"})]})}),e.jsx("input",{readOnly:!x,type:"text",...d("COD_AREA",{required:!0}),className:j("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":s.COD_AREA}),placeholder:"Ingrese Código"}),s.COD_AREA&&e.jsx("p",{className:"text-red-500 text-sm",children:"El Código es requerido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Detalle"}),e.jsx("input",{type:"text",...d("detalle",{required:!0}),className:j("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":s.detalle}),placeholder:"Nombre"}),s.detalle&&e.jsx("p",{className:"text-red-500 text-sm",children:"el Nombre de la Area  es requerida"})]})]})]})})})})]})},z=()=>{const{id:a}=F();v();const{isLoading:r,isError:i,data:o,mutation:n,mutationDelete:l,handleDelete:u,handleSubmit:d}=I(a||""),t=a==="new"?"Nuevo Area":"Editar Area",s=a==="new"?"Aquí puedes crear una nueva Area.":"Aquí puedes editar la Area.";return i?e.jsx(A,{to:"/admin/area"}):r?e.jsx(p,{}):o?e.jsx(e.Fragment,{children:e.jsx(K.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(L,{title:t,subTitle:s,clase:o,onSubmit:d,handleDelete:u,isPending:n.isPending,isDeleting:l.isPending})})}):e.jsx(A,{to:"/admin/area"})};export{z as AdminAreaPage,z as default};
