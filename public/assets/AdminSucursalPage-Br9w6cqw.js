import{i as b,k as N,u as w,l as C,m as y,n as E,t as g,o as m,p as A,b as q,j as e,e as p,A as D,B as f,L as U,X as P,q as B,T as k,s as L,v as S,w as T,N as j,r as F}from"./index-BwH_Ncr2.js";const O=async s=>{if(!s)throw new Error("Id is required");if(s==="new")return console.log("llega a new"),{id:"new",COD_SUCURSAL:"",detalle:""};const{data:a}=await b.get(`/sucursal/${s}`);return a},$=async s=>{const{id:a,files:o=[],...i}=s,l=a==="new";console.log("like in action create"),console.log({userLike:s});const{data:n}=await b({url:l?"/sucursal/":`/sucursal/${a}`,method:l?"POST":"PUT",data:{...i}});return{...n}},Q=async s=>{console.log(s);const{data:a}=await b({url:`/sucursal/${s}`,method:"DELETE"});return{...a}},R=s=>{const a=N(),o=w(),i=C({queryKey:["sucursal",{id:s}],queryFn:()=>O(s),retry:!1,staleTime:1e3*60*.5}),l=y({mutationFn:$,onSuccess:t=>{a.invalidateQueries({queryKey:["sucursales"]}),a.invalidateQueries({queryKey:["sucursal"]})}}),n=y({mutationFn:Q,onSuccess:t=>{a.invalidateQueries({queryKey:["ubicaciones"]}),o(-1),g.success("Ubicación eliminada correctamente")},onError:t=>{console.error(t),g.error("Error al eliminar ubicación")}});return{...i,mutation:l,mutationDelete:n,handleSubmit:async t=>{event?.preventDefault(),console.log("onsubmit",t),await l.mutateAsync(t,{onSuccess:r=>{console.log({data:r});let c="Sucursal actualizada ";t.id==="new"&&(c="Sucursal Creada "),m.fire({title:"Exito",text:c,icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),o(`/admin/sucursal/${r.id}`)},onError:r=>{m.fire({title:"<b>Error al Guardar</b>",text:`${r?.response?.data?.error||r?.response?.data?.message||r.message||"Error desconocido"}`,icon:"error"})}})},handleDelete:async t=>{(await E()).isConfirmed&&await n.mutateAsync(t,{onSuccess:c=>{m.fire({title:"Exito",text:"Eliminado Correctamente",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,timerProgressBar:!0,background:"#1f2937",color:"#f9fafb"}),o(`/admin/sucursal/${c.id}`)},onError:c=>{console.log(c),g.success("Error al Eliminar"),m.fire({title:"Error",text:"Error al Eliminar",icon:"error",confirmButtonColor:"#16a34a",background:"#1f2937",color:"#f9fafb"})}})}}},I=({title:s,subTitle:a,onSubmit:o,handleDelete:i,clase:l,isPending:n,isDeleting:d})=>{const{register:u,handleSubmit:t,formState:{errors:r},getValues:c,setValue:K,watch:_}=A({defaultValues:l}),h=q().pathname.split("/").filter(Boolean),v=h[h.length-1];let x=!1;return v==="new"&&(x=!0),n||d?e.jsx(p,{}):e.jsxs("form",{className:"py-0 pb-10",onSubmit:t(o),children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 flex flex-col gap-4",children:[e.jsx(D,{title:s,subtitle:a}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{variant:"outline",type:"button",children:e.jsxs(U,{to:"/admin/sucursal",className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),"Cancelar"]})}),e.jsxs(f,{type:"submit",disabled:n,children:[e.jsx(B,{className:"w-4 h-4"}),"Guardar"]}),!x&&e.jsxs(f,{onClick:()=>i(+l.id),variant:"destructive",type:"button",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-0 sm:px-0 lg:px-8 py-8",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:"Información de Sucursal"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-slate-700 mb-2",children:["Código",e.jsx("img",{src:L,alt:"Campo llave",className:"w-4 h-4 ml-2"})]})}),e.jsx("input",{readOnly:!x,type:"text",...u("COD_SUCURSAL",{required:!0}),className:S("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200","read-only:bg-gray-100 read-only:text-gray-500 read-only:cursor-not-allowed",{"border-red-500":r.COD_SUCURSAL}),placeholder:"Ingrese Código"}),r.COD_SUCURSAL&&e.jsx("p",{className:"text-red-500 text-sm",children:"El Código es requerido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Detalle"}),e.jsx("input",{type:"text",...u("detalle",{required:!0}),className:S("w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all duration-200",{"border-red-500":r.detalle}),placeholder:"Nombre"}),r.detalle&&e.jsx("p",{className:"text-red-500 text-sm",children:"el Nombre de la Sucursal  es requerida"})]})]})]})})})})]})},z=()=>{const{id:s}=T();w();const{isLoading:a,isError:o,data:i,mutation:l,mutationDelete:n,handleDelete:d,handleSubmit:u}=R(s||""),t=s==="new"?"Nueva Sucursal":"Editar Sucursal",r=s==="new"?"Aquí puedes crear una nueva Sucursal.":"Aquí puedes editar la Sucursal.";return o?e.jsx(j,{to:"/admin/sucursal"}):a?e.jsx(p,{}):i?e.jsx(e.Fragment,{children:e.jsx(F.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(I,{title:t,subTitle:r,clase:i,onSubmit:u,handleDelete:d,isPending:l.isPending,isDeleting:n.isPending})})}):e.jsx(j,{to:"/admin/sucursal"})};export{z as AdminSucursalPage,z as default};
