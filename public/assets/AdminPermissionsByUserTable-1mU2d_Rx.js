import{i as S,r as c,af as E,ak as _,j as n,ad as V,_ as A,ai as Q,v as J,l as Y,c as Z,al as ee,am as te,an as ne,ao as se,ap as re,e as oe,X as ae,a7 as ie,a8 as ce,a9 as j,aa as U,aq as O,ab as le,ac as I,A as de,o as k}from"./index-DZARsHZ9.js";import{u as ue,a as me}from"./index-DNjyO5m7.js";import{C as pe}from"./check-CogEsa6Z.js";const fe=async e=>{const{permissionId:t,userId:s}=e;console.log("userPermission in action DELETE"),console.log({userLike:e});const{data:a}=await S({url:`/user-permissions/${s}/${t}`,method:"DELETE",data:{userId:s,permissionId:t}});return a},ge=async e=>{const{id:t,permissionId:s,userId:a,fecha_permiso:i,files:r=[]}=e,l=t==="new";console.log("userPermission in action create"),console.log({userLike:e});let p=0;t!=="new"&&(p=+t);const{data:d}=await S({url:l?"/user-permissions/":`/user-permissions/${t}`,method:l?"POST":"PUT",data:{...e,id:p}});return{...d}};function F(e,t,{checkForDefaultPrevented:s=!0}={}){return function(i){if(e?.(i),s===!1||!i.defaultPrevented)return t?.(i)}}function he(e,t){return c.useReducer((s,a)=>t[s][a]??s,e)}var B=e=>{const{present:t,children:s}=e,a=xe(t),i=typeof s=="function"?s({present:a.isPresent}):c.Children.only(s),r=E(a.ref,be(i));return typeof s=="function"||a.isPresent?c.cloneElement(i,{ref:r}):null};B.displayName="Presence";function xe(e){const[t,s]=c.useState(),a=c.useRef(null),i=c.useRef(e),r=c.useRef("none"),l=e?"mounted":"unmounted",[p,d]=he(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return c.useEffect(()=>{const m=w(a.current);r.current=p==="mounted"?m:"none"},[p]),_(()=>{const m=a.current,h=i.current;if(h!==e){const f=r.current,x=w(m);e?d("MOUNT"):x==="none"||m?.display==="none"?d("UNMOUNT"):d(h&&f!==x?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,d]),_(()=>{if(t){let m;const h=t.ownerDocument.defaultView??window,g=x=>{const C=w(a.current).includes(CSS.escape(x.animationName));if(x.target===t&&C&&(d("ANIMATION_END"),!i.current)){const u=t.style.animationFillMode;t.style.animationFillMode="forwards",m=h.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=u)})}},f=x=>{x.target===t&&(r.current=w(a.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",g),t.addEventListener("animationend",g),()=>{h.clearTimeout(m),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",g),t.removeEventListener("animationend",g)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(p),ref:c.useCallback(m=>{a.current=m?getComputedStyle(m):null,s(m)},[])}}function w(e){return e?.animationName||"none"}function be(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}var P="Checkbox",[ye,Ee]=V(P),[Ce,T]=ye(P);function ve(e){const{__scopeCheckbox:t,checked:s,children:a,defaultChecked:i,disabled:r,form:l,name:p,onCheckedChange:d,required:m,value:h="on",internal_do_not_use_render:g}=e,[f,x]=Q({prop:s,defaultProp:i??!1,onChange:d,caller:P}),[y,C]=c.useState(null),[u,o]=c.useState(null),b=c.useRef(!1),N=y?!!l||!!y.closest("form"):!0,R={checked:f,disabled:r,setChecked:x,control:y,setControl:C,name:p,form:l,value:h,hasConsumerStoppedPropagationRef:b,required:m,defaultChecked:v(i)?!1:i,isFormControl:N,bubbleInput:u,setBubbleInput:o};return n.jsx(Ce,{scope:t,...R,children:Ne(g)?g(R):a})}var D="CheckboxTrigger",L=c.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:s,...a},i)=>{const{control:r,value:l,disabled:p,checked:d,required:m,setControl:h,setChecked:g,hasConsumerStoppedPropagationRef:f,isFormControl:x,bubbleInput:y}=T(D,e),C=E(i,h),u=c.useRef(d);return c.useEffect(()=>{const o=r?.form;if(o){const b=()=>g(u.current);return o.addEventListener("reset",b),()=>o.removeEventListener("reset",b)}},[r,g]),n.jsx(A.button,{type:"button",role:"checkbox","aria-checked":v(d)?"mixed":d,"aria-required":m,"data-state":K(d),"data-disabled":p?"":void 0,disabled:p,value:l,...a,ref:C,onKeyDown:F(t,o=>{o.key==="Enter"&&o.preventDefault()}),onClick:F(s,o=>{g(b=>v(b)?!0:!b),y&&x&&(f.current=o.isPropagationStopped(),f.current||o.stopPropagation())})})});L.displayName=D;var q=c.forwardRef((e,t)=>{const{__scopeCheckbox:s,name:a,checked:i,defaultChecked:r,required:l,disabled:p,value:d,onCheckedChange:m,form:h,...g}=e;return n.jsx(ve,{__scopeCheckbox:s,checked:i,defaultChecked:r,disabled:p,required:l,onCheckedChange:m,name:a,form:h,value:d,internal_do_not_use_render:({isFormControl:f})=>n.jsxs(n.Fragment,{children:[n.jsx(L,{...g,ref:t,__scopeCheckbox:s}),f&&n.jsx($,{__scopeCheckbox:s})]})})});q.displayName=P;var H="CheckboxIndicator",z=c.forwardRef((e,t)=>{const{__scopeCheckbox:s,forceMount:a,...i}=e,r=T(H,s);return n.jsx(B,{present:a||v(r.checked)||r.checked===!0,children:n.jsx(A.span,{"data-state":K(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});z.displayName=H;var W="CheckboxBubbleInput",$=c.forwardRef(({__scopeCheckbox:e,...t},s)=>{const{control:a,hasConsumerStoppedPropagationRef:i,checked:r,defaultChecked:l,required:p,disabled:d,name:m,value:h,form:g,bubbleInput:f,setBubbleInput:x}=T(W,e),y=E(s,x),C=ue(r),u=me(a);c.useEffect(()=>{const b=f;if(!b)return;const N=window.HTMLInputElement.prototype,M=Object.getOwnPropertyDescriptor(N,"checked").set,G=!i.current;if(C!==r&&M){const X=new Event("click",{bubbles:G});b.indeterminate=v(r),M.call(b,v(r)?!1:r),b.dispatchEvent(X)}},[f,C,r,i]);const o=c.useRef(v(r)?!1:r);return n.jsx(A.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??o.current,required:p,disabled:d,name:m,value:h,form:g,...t,tabIndex:-1,ref:y,style:{...t.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});$.displayName=W;function Ne(e){return typeof e=="function"}function v(e){return e==="indeterminate"}function K(e){return v(e)?"indeterminate":e?"checked":"unchecked"}function ke({className:e,...t}){return n.jsx(q,{"data-slot":"checkbox",className:J("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(z,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:n.jsx(pe,{className:"size-3.5"})})})}const we=async e=>{const{userId:t}=e||{},{data:s}=await S.get("/permissions/getbyuserid",{params:{userId:t}});return console.log(s),s},Pe=e=>Y({queryKey:["findPermissionsByUserId",{userId:e}],queryFn:()=>we({userId:+e}),retry:!1,staleTime:1e3*60*1}),Re=({data:e,columns:t,onPermissionChange:s})=>{const[a,i]=c.useState(!1);Z();const r=c.useRef(null);r.current;const l=()=>{r.current&&(r.current.focus(),h(""))},[p,d]=c.useState([]),[m,h]=c.useState(""),g=(u,o,b,N)=>{s({val:u,permissionId:b,userId:N}),o.active=!o.active},f=ee({data:e,columns:t,getCoreRowModel:re(),getPaginationRowModel:se(),getSortedRowModel:ne(),getFilteredRowModel:te(),state:{sorting:p,globalFilter:m},onSortingChange:d,onGlobalFilterChange:h});f.getState().pagination.pageSize=50;const x=9,y=f.getRowModel().rows,C=x-y.length;return a?n.jsx(oe,{}):n.jsxs("div",{className:"overflow-x-auto ",children:[n.jsxs("div",{className:"py-2  pb-2 relative",children:[n.jsx("input",{ref:r,type:"text",value:m,onChange:u=>h(u.target.value),placeholder:"Buscar...",className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),n.jsx("button",{onClick:l,type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-full p-2 cursor-pointer transition-colors",children:n.jsx(ae,{size:18})})]}),n.jsx("div",{className:"w-full overflow-x-auto",children:n.jsxs(ie,{className:`\r
      min-w-full bg-white text-sm \r
      md:text-base    /* texto más grande en pantallas medianas */\r
      rounded-lg shadow-sm border\r
    `,children:[n.jsx(ce,{className:"bg-gray-100",children:f.getHeaderGroups().map(u=>n.jsxs(j,{children:[u.headers.map(o=>n.jsx(U,{onClick:o.column.getToggleSortingHandler(),className:`\r
                whitespace-nowrap px-2 py-1 md:px-4 md:py-2 \r
                font-semibold text-gray-700 text-xs md:text-sm \r
                cursor-pointer select-none\r
              `,children:o.isPlaceholder?null:n.jsxs("div",{className:"flex items-center gap-1",children:[O(o.column.columnDef.header,o.getContext()),o.column.getIsSorted()==="asc"?" ▲":o.column.getIsSorted()==="desc"?" ▼":null]})},o.id)),n.jsx(U,{className:"whitespace-nowrap px-2 py-1 md:px-4 md:py-2 font-semibold text-gray-700 text-xs md:text-sm",children:"Acciones"})]},u.id))}),n.jsxs(le,{className:"divide-y divide-gray-200",style:{minHeight:"600px"},children:[f.getRowModel().rows.map(u=>n.jsxs(j,{className:"border-t hover:bg-gray-50 transition-colors",children:[u.getVisibleCells().map(o=>n.jsx(I,{className:`\r
                whitespace-nowrap px-2 py-1 md:px-4 md:py-2 \r
                text-gray-700 text-xs md:text-sm\r
              `,children:O(o.column.columnDef.cell,o.getContext())},o.id)),n.jsx(I,{className:"text-center px-2 py-1 md:px-4 md:py-2",children:n.jsx(ke,{onCheckedChange:o=>g(!!o,u.original,u.original.id,u.original.userId),id:`toggle-${u.original.id}`,checked:u.original.active===!0,className:"scale-90 md:scale-100"})})]},u.id)),C>0&&Array.from({length:C}).map((u,o)=>n.jsx(j,{className:"opacity-0",children:t.map((b,N)=>n.jsx(I,{children:"."},N))},`empty-${o}`))]})]})})]})},Ae=({userId:e})=>{const t=Pe(e||""),[s,a]=c.useState([]);console.log({data:t});const i=async l=>{if(console.log("llega al padre"),console.log({updated:l}),k.fire({title:"Actualizando...",background:"#1f2937",color:"#f9fafb",html:'<div class="loader-green"></div>',allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{k.showLoading()},width:"300px"}),l.val){const p=await ge({id:"new",userId:l.userId,permissionId:l.permissionId});console.log({newUserPermission:p}),k.close()}else{const p=await fe({userId:l.userId,permissionId:l.permissionId});k.close(),console.log({deleteUserPermission:p})}a(["abc"])},r=[{header:"Descripcion",accessorKey:"detalle"}];return c.useEffect(()=>{console.log("llega al UseEffect")},[s]),n.jsx(n.Fragment,{children:n.jsx("div",{className:"pb-20 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:n.jsx("div",{className:"lg:col-span-2 space-y-6",children:n.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6",children:n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex justify-between items-center",children:n.jsx(de,{title:"Permisos del Usuario",subtitle:"Aquí puedes ver y administrar los Permisos del  Usuario"})}),n.jsx("div",{children:n.jsx(Re,{data:t?.data||[],columns:r,userId:e,onPermissionChange:i})})]})})})})})})};export{Ae as AdminPermissionsByUserTable,Ae as default};
